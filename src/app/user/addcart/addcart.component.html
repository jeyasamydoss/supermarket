<div class="container-fluid">
    <img src="/assets/bg-shop.jpg" alt="Snow" style="width:100%;">
    <div class="centered h1">CART PAGE</div>
</div>

<section class="section section-xl bg-default">
    <div class="container">
        <div class="table-custom-responsive">
            <table class="table-custom table-cart">
                <thead>
                    <tr>
                        <th>Product name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of cartItems; let i = index">
                        <td>
                            <img [src]="getImageUrl(item.image)" alt="" width="146" height="132">
                            <span>{{ item.productName }}</span>
                        </td>
                        <td><i class="fa-solid fa-indian-rupee-sign"></i>{{ item.price  }}</td>
                        <td>
                            <div class="table-cart-stepper">
                                <div class="stepper">
                                    <input class="form-input stepper-input" type="number" data-zeros="true" value="1" min="1" max="1000" (input)="updateQuantity(i, $event)">
                                    <span class="stepper-arrow up"></span>
                                    <span class="stepper-arrow down"></span>
                                </div>
                            </div>
                        </td>
                        <td> <i class="fa-solid fa-indian-rupee-sign"></i>{{ calculateTotal(item) }}</td>
                       <td><mat-icon (click)="deleteItem(item.id)" style="color: red;">delete_outline</mat-icon></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="group-xl group-justify mt-5">
            <div class="total-section">
                <div class="group-md group-middle">
                    <div class="heading-5 fw-medium text-gray-500">Total <i class="fa-solid fa-indian-rupee-sign"></i>{{ calculateGrandTotal() }}</div>
                </div>
            </div>
            <button *ngIf="!buy" class="button button-lg button-primary button-zakaria" (click)="gotocheckout()">Proceed to checkout</button>
        </div>
    </div>
</section>

<div *ngIf="buy" class="container mt-5">
    <div class="row">
      <div class="col-sm-6">
  
        <div style="background-image: url('/assets/map.png'); width: 400px; height: 500px; background-repeat: no-repeat;">
        </div>
      </div>
      <div class="col-sm-6 col-lg-6">
        <h2 class="style">
          Delivery Address
        </h2>
        <form [formGroup]="checkForm" (ngSubmit)="order()">
          <div class="container mt-5">
            <div class="row">
              <div class="col-sm-6 col-lg-6">
                <div class="user-box">
                  <span style="color: red;" class="me-1" *ngIf="firstName?.invalid && firstName?.touched">
                    <span *ngIf="firstName?.errors?.['required']" class="formvalidation">
                      *Frist name required
                    </span>
                  </span>
                  <input type="text" name="firstname" formControlName="firstName" required>
                  <label for="firstname">First Name</label>
                </div>
              </div>
              <div class="col-sm-6 col-lg-6">
                <div class="user-box">
                  <input type="text" name="lastname" formControlName="lastName" required>
  
                  <span style="color: red;" *ngIf="lastName?.invalid && lastName?.touched">
                    <span *ngIf="lastName?.errors?.['required']" class="formvalidation">
                      *last name required
                    </span>
                  </span>
                  <label for="lastname">Last Name</label>
                </div>
              </div>
            </div>
            <div class="user-box ">
              <div class="col-sm-12">
                <input type="text" name="landmark" formControlName="landmark" required>
  
                <span style="color: red;" *ngIf="landmark?.invalid && landmark?.touched">
                  <span *ngIf="landmark?.errors?.['required']" class="formvalidation">
                    *Landmark required
                  </span>
                </span>
                <label for="landmark">Landmark</label>
              </div>
            </div>
            <div class="user-box">
              <div class="col-sm-12">
                <input type="text" name="address" formControlName="address" required>
  
                <span style="color: red;" *ngIf="address?.invalid && address?.touched">
                  <span *ngIf="address?.errors?.['required']" class="formvalidation">
                    *Address required
                  </span>
                </span>
                <label for="address">Address</label>
              </div>
            </div>
  
            <div class="user-box">
  
              <div class="col-sm-12">
                <input type="text" name="email" formControlName="email" required>
  
                <span style="color: red;" *ngIf="email?.invalid && email?.touched">
                  <span *ngIf="email?.errors?.['required']" class="formvalidation">
                    *Email required
                  </span>
                </span>
                <label for="email">Email</label>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-6 col-lg-6">
                <div class="user-box">
                  <div class="row">
                    <div class="col-sm-12 ">
                      <input type="number" name="mobile" formControlName="mobile" required>
  
                      <span style="color: red;" *ngIf="mobile?.invalid && mobile?.touched">
                        <span *ngIf="mobile?.errors?.['required']" class="formvalidation">
                          *Mobile required
                        </span>
                      </span>
                      <label for="mobile">Mobile</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-lg-6">
                <div class="user-box">
                  <input type="number" name="pincode" formControlName="pincode" required>
  
  
                  <span style="color: red;" *ngIf="pincode?.invalid && pincode?.touched">
                    <span *ngIf="pincode?.errors?.['required']" class="formvalidation">
                      *pincode required
                    </span>
                  </span>
                  <label for="pincode">pincode</label>
                </div>
              </div>
            </div>
          </div>
  
          <button class="btn btn-warning w-100 my-3" type="submit">Buy Now</button>
        </form>
      </div>
    </div>
  </div>
